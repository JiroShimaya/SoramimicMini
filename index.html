<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Soramimic</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="js/utils.js"></script>
<script src="js/kuromoji/build/kuromoji.js"></script>
</head>
<script>
var MorphologicalAnalyzer = function(){
	this.tokenizer;
	this.test = "";
	kuromoji.builder({dicPath:"js/kuromoji/dict"}).build(function(err, tokenizer){
		if(err) { throw err; }
		this.tokenizer = tokenizer;
		this.test = "a"
		console.log(this.test);
	});
	this.getYomi = function(strVal){
		var yomi = "";
		console.log(this.test);
		this.tokenizer.tokenize(strVal).forEach(function(val){
			yomi += val.pronunciation;
		});
		return yomi;
	}
}

var ma = new MorphologicalAnalyzer();
var testText = "こんにちは";
setTimeout(function(){
	console.log(ma.getYomi(testText));	
},5000);
function loadDatabaseText(text){
	var words = [];
	text.split("\n").forEach(function(val){
		val = val.replace(/\u200B/g, "");//エスケープ処理
		val = val.split("#")[0].split(",");//各行において#以降をコメントアウトして、カンマでスプリット
		words.push(val);
	});
	var ma = new MorphologicalAnalyzer(),
		result = {}
	words.forEach(function(val,index){
		if(val.length == 0){
			
		}
		else{
			if(val.length == 1){
				val.push(val[0]);
			}
			var title = val[0];
			val.slice(1).forEach(function(val2){
				var yomi = ma.getYomi(val2);
				if(!(yomi.length in result)){
					result[yomi.length]=[];
				}
				result[yomi.length].push(yomi);
			});
		}
	});	
}

</script>
<body>
	<div class="container-fluid">
		<div class="row">
			<div class="col-xs-12 col-sm-6">
				<input type = "text" class="form-control">
			</div>
			<div class="col-xs-12 col-sm-6">
				<textarea class="form-control"></textarea>
			</div>
		</div>
	</div>

</body>
</html>